<div class="form-container">
  <h1>
    {{ edicion ? 'Editar presupuesto mensual' : 'Nuevo presupuesto mensual' }}
  </h1>

  <form [formGroup]="form" (ngSubmit)="aceptar()">
    <!-- FILA: AÑO / MES -->
    <div class="row">
      <!-- Año -->
      <mat-form-field class="half" appearance="outline">
        <mat-label>Año</mat-label>
        <input
          matInput
          type="number"
          formControlName="anioPresupuestoMensual"
          min="2000"
          max="2100"
        />
        <mat-error *ngIf="isInvalid('anioPresupuestoMensual')">
          El año es obligatorio (entre 2000 y 2100).
        </mat-error>
      </mat-form-field>

      <!-- Mes -->
      <mat-form-field class="half" appearance="outline">
        <mat-label>Mes</mat-label>
        <mat-select formControlName="mesPresupuestoMensual">
          <mat-option *ngFor="let m of meses" [value]="m.valor">
            {{ m.label }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="isInvalid('mesPresupuestoMensual')"> El mes es obligatorio. </mat-error>
      </mat-form-field>
    </div>

    <!-- FILA: MONTO / FECHA -->
    <div class="row">
      <!-- Monto límite -->
      <mat-form-field class="half" appearance="outline">
        <mat-label>Monto límite (S/.)**</mat-label>
        <input matInput type="number" step="0.01" formControlName="montoLimitePresupuestoMensual" />
        <mat-error *ngIf="isInvalid('montoLimitePresupuestoMensual')">
          El monto es obligatorio y debe ser mayor a 0.
        </mat-error>
      </mat-form-field>

      <!-- Fecha presupuesto -->
      <mat-form-field class="half" appearance="outline">
        <mat-label>Fecha presupuesto</mat-label>
        <input matInput [matDatepicker]="pickerFecha" formControlName="fechaPresupuestoMensual" />
        <mat-datepicker-toggle matIconSuffix [for]="pickerFecha"></mat-datepicker-toggle>
        <mat-datepicker #pickerFecha></mat-datepicker>
        <mat-error *ngIf="isInvalid('fechaPresupuestoMensual')">
          La fecha es obligatoria.
        </mat-error>
      </mat-form-field>
    </div>

    <!-- FILA: USUARIO (COMPLETA) -->
    <div class="row">
      <mat-form-field class="full-width" appearance="outline">
        <mat-label>Usuario</mat-label>
        <mat-select formControlName="idUsuario">
          <mat-option *ngFor="let u of usuarios" [value]="u.idUsuario">
            {{ u.nombreUsuario }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="isInvalid('idUsuario')"> El usuario es obligatorio. </mat-error>
      </mat-form-field>
    </div>

    <div class="buttons">
      <button mat-raised-button color="primary" type="submit">
        {{ edicion ? 'Guardar cambios' : 'Registrar' }}
      </button>
      <button mat-raised-button type="button" (click)="cancelar()">Cancelar</button>
    </div>
  </form>
</div>
