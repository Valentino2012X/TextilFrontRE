<div class="form-container">
  <h1>{{ edicion ? 'Editar favorito' : 'Nuevo favorito' }}</h1>

  <form [formGroup]="form" (ngSubmit)="aceptar()">
    <!-- FECHA -->
    <div class="row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Fecha de favorito</mat-label>
        <input
          matInput
          [matDatepicker]="pickerFecha"
          formControlName="fechaFavorito"
        />
        <mat-datepicker-toggle
          matIconSuffix
          [for]="pickerFecha"
        ></mat-datepicker-toggle>
        <mat-datepicker #pickerFecha></mat-datepicker>
        <mat-error *ngIf="campoInvalido('fechaFavorito')">
          La fecha es obligatoria.
        </mat-error>
      </mat-form-field>
    </div>

    <!-- USUARIO / PRODUCTO / PROYECTO -->
    <div class="row">
      <mat-form-field appearance="outline">
        <mat-label>Usuario</mat-label>
        <mat-select formControlName="idUsuario">
          <mat-option *ngFor="let u of listaUsuarios" [value]="u.idUsuario">
            {{ u.nombreUsuario }} (ID: {{ u.idUsuario }})
          </mat-option>
        </mat-select>
        <mat-error *ngIf="campoInvalido('idUsuario')">
          Debes seleccionar un usuario.
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Producto (opcional)</mat-label>
        <mat-select formControlName="idProducto">
          <mat-option [value]="null">— Ninguno —</mat-option>
          <mat-option *ngFor="let p of listaProductos" [value]="p.idProducto">
            {{ p.nombreProducto }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Proyecto (opcional)</mat-label>
        <mat-select formControlName="idProyecto">
          <mat-option [value]="null">— Ninguno —</mat-option>
          <mat-option
            *ngFor="let pr of listaProyectos"
            [value]="pr.idProyecto"
          >
            {{ pr.tituloProyecto }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <button
      mat-raised-button
      color="primary"
      type="submit"
      class="btn-guardar"
    >
      Guardar
    </button>
  </form>
</div>
