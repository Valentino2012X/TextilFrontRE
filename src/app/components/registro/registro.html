<div class="registro-wrapper">
  <div class="registro-card">
    <div class="registro-logo">
      <div class="logo-badge">TC</div>
    </div>

    <h2 class="registro-title">Crear cuenta</h2>
    <p class="registro-subtitle">Reg√≠strate como <b>Estudiante</b> o <b>Vendedor</b>.</p>

    <form [formGroup]="form" (ngSubmit)="registrar()">
      <!-- Nombre -->
      <label class="label">Nombre completo</label>
      <input class="dark-input" type="text" formControlName="nombreUsuario" placeholder="Ej: Juan P√©rez" />
      <div class="input-hint error" *ngIf="f.nombreUsuario.touched && f.nombreUsuario.invalid">
        Nombre obligatorio (2‚Äì100).
      </div>

      <!-- Email -->
      <label class="label">Correo</label>
      <input class="dark-input" type="email" formControlName="emailUsuario" placeholder="correo@ejemplo.com" />
      <div class="input-hint error" *ngIf="f.emailUsuario.touched && f.emailUsuario.invalid">
        Correo inv√°lido.
      </div>

      <!-- Username -->
      <label class="label">Usuario</label>
      <input class="dark-input" type="text" formControlName="username" placeholder="Ej: juanp" />
      <div class="input-hint error" *ngIf="f.username.touched && f.username.invalid">
        Usuario obligatorio (3‚Äì50).
      </div>

      <!-- Password -->
      <label class="label">Contrase√±a</label>
      <input class="dark-input" type="password" formControlName="password" placeholder="M√≠nimo 6 caracteres" />
      <div class="input-hint error" *ngIf="f.password.touched && f.password.invalid">
        Contrase√±a m√≠nimo 6 caracteres.
      </div>

      <!-- Tel√©fono -->
      <label class="label">Tel√©fono</label>
      <input class="dark-input" type="text" formControlName="telefonoUsuario" placeholder="Ej: 999888777" />
      <div class="input-hint error" *ngIf="f.telefonoUsuario.touched && f.telefonoUsuario.invalid">
        Tel√©fono obligatorio.
      </div>

      <!-- Direcci√≥n -->
      <label class="label">Direcci√≥n</label>
      <input class="dark-input" type="text" formControlName="direccionUsuario" placeholder="Ej: Av. Siempre Viva 123" />
      <div class="input-hint error" *ngIf="f.direccionUsuario.touched && f.direccionUsuario.invalid">
        Direcci√≥n obligatoria.
      </div>

      <!-- URL de foto -->
      <label class="label">URL de foto (opcional)</label>
      <input
        class="dark-input"
        type="text"
        formControlName="fotoUrl"
        placeholder="https://ejemplo.com/mi-foto.jpg"
      />
      <div class="input-hint">
        Si no colocas nada, usaremos una imagen por defecto en tu perfil.
      </div>

      <!-- üñº Preview de la foto -->
      <div class="input-hint" style="margin-top: 8px;">
        Vista previa:
      </div>
      <div style="display:flex; justify-content:center; margin-bottom: 10px;">
        <img
          [src]="form.value.fotoUrl || 'assets/avatar-default.png'"
          alt="Preview foto"
          style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;"
        />
      </div>

      <!-- Rol -->
      <label class="label">Rol</label>
      <select class="dark-input" formControlName="idRol">
        <option [ngValue]="null">Selecciona‚Ä¶</option>
        <option *ngFor="let r of roles" [ngValue]="r.idRol">
          {{ r.nombreRol }}
        </option>
      </select>
      <div class="input-hint error" *ngIf="f.idRol.touched && f.idRol.invalid">
        Debes elegir ESTUDIANTE o VENDEDOR.
      </div>

      <!-- mensajes -->
      <div class="msg success" *ngIf="successMsg">{{ successMsg }}</div>
      <div class="msg error" *ngIf="errorMsg">{{ errorMsg }}</div>

      <!-- acciones -->
      <div class="acciones">
        <button type="button" class="btn-cancelar" (click)="cancelar()">Cancelar</button>

        <button type="submit" class="btn-guardar" [class.is-loading]="cargando">
          {{ cargando ? 'Registrando‚Ä¶' : 'Registrarse' }}
        </button>
      </div>

      <p class="login-link">
        ¬øYa tienes cuenta?
        <a routerLink="/login">Inicia sesi√≥n</a>
      </p>
    </form>
  </div>
</div>
